---
title: "Classification - Exercises"
output:
  html_document:
  df_print: paged
pdf_document: default
date: 14. June 2022
author: Mateusz Gruszczy≈Ñski
---
  
<style>
body {
text-align: justify}
</style>
  
```{r, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
install.packages("mlbench")
install.packages("rattle")
install.packages("caret")
install.packages("dplyr")
```

```{r, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
library(mlbench)
library(rattle)
data("PimaIndiansDiabetes")
```
# Exercises and Answers

**1. Using the `Vehicle` set from the `mlbench` package. Construct a KNN model for parameters k from 1 to 5. Which one gives the best results? What is the re-substitution error and LOO CV error. Make a confusion matrix. After loading the package, load the Vehicle dataset as follow.**

```{r, warning = FALSE, message = FALSE}
data(Vehicle)
```

Proposed answer:
  
```{r, eval = TRUE, warning = FALSE, message = FALSE}
library(caret)
library(mlbench)
library(dplyr)
data(Vehicle)

data_set <- Vehicle

ctrl.loo <- trainControl(method = 'LOOCV',
                         search = 'grid') 

(model.knn <- train(Class ~ ., 
                    data = data_set, 
                    method = 'knn', 
                    tuneGrid = data.frame(k = 1:5),
                    trControl = ctrl.loo))
1-model.knn$results[2] #boot error rate 

mean(predict(model.knn) != data_set$Class) #resubtitution error

confusionMatrix(predict(model.knn), data_set$Class)

```


**2. Using the `leafshape` set from the `DAAG` package. Construct a naive Bayesian model and see how much CV LOO and re-substitution error. What the accuracy is?**

Proposed answer:
  
```{r, eval = TRUE, warning = FALSE, message = FALSE}
library(caret)
library(DAAG)
library(dplyr)

data_set <- leafshape

ctrl.loo <- trainControl(method = 'LOOCV',
                         search = 'grid') 

(model.nb <- train(location ~ ., 
                   data = data_set, 
                   method = 'nb',
                   trControl = ctrl.loo))

1-model.nb$results[2] #boot error rate 

mean(predict(model.nb) != data_set$location) #resubtitution error

```


**3. Using the `painters` set from the `MASS` package. Construct a LDA model. What is the re-substitution error and LOO CV error. Make a confusion matrix.**

Proposed answer:
  
```{r, eval = TRUE, warning = FALSE, message = FALSE}
library(caret)
library(MASS)
library(dplyr)

data_set <- painters

ctrl.loo <- trainControl(method = 'LOOCV',
                         search = 'grid') 

(model.lda <- train(School ~ ., 
                    data = data_set, 
                    method = 'lda',
                    trControl = ctrl.loo))

1-model.lda$results[2] #boot error rate 

mean(predict(model.lda) != data_set$School) #resubtitution error

confusionMatrix(predict(model.lda), data_set$School)

```


**4. Using the `Cars93` set from the `MASS` package. Construct a classification tree where the variable Type depends on the variables Length, Weight, Engine, Size, Horsepower, RPM and tuneLength = 5. What is the re-substitution error and LOO CV error. Make a confusion matrix and plot.**

Proposed answer:
  
```{r, eval = TRUE, warning = FALSE, message = FALSE}

library(caret)
library(MASS)
library(dplyr)
library(rattle)

data_set <- Cars93

ctrl.loo <- trainControl(method = 'LOOCV',
                         search = 'grid') 

(model.tree <- train(Type ~ Length + Weight + EngineSize + Horsepower + RPM, 
                     data = data_set, 
                     method = 'rpart',
                     trControl = ctrl.loo,
                     tuneLength = 5))

1-model.tree$results[2] #boot error rate 

mean(predict(model.tree) != data_set$Type) #resubtitution error

confusionMatrix(predict(model.tree), data_set$Type)

fancyRpartPlot(model.tree$finalModel)
```